<!-- Create another page that allows you to perform the remaining CRUD actions 
 (mainly create [POST], update [POST or PUT], and delete [DELETE]) on any data in 
 either the localStorage or cloud-based version through a form (displaying the 
 <project-card> elements in part 2 can count as the "Read" portion of CRUD and 
 does not have to be on a separate page). For simplicity, you do not have to 
 worry about making the localStorage and cloud data consistent with each other. 
 Changes should take effect upon the next load of your <project-cards> 
 (via "load local" or "load remote" whichever is applicable) -->

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Project Card CRUD Actions</title>
        <link rel="stylesheet" href="styles/main.css">
        <link rel="stylesheet" href="fonts/archivo-narrow/an.css">
        <link rel="stylesheet" href="fonts/general-sans/gs.css">
        <style>
            body {
                padding: 3rem;
            }
            form {
                border: 1px solid var(--text-alt);
                background-color: var(--accent);
                padding: 2.5rem;

                & fieldset {
                    border: none;
                    padding: 0;
                    margin: 0;

                    & legend {
                        color: var(--primary);
                        font-size: 1.5rem;
                        font-weight: 700;
                        margin-bottom: 1rem;
                        padding: 0;
                    }

                    & div {
                        width: 100%;
                        margin-bottom: 1.5rem;
                        display: flex;
                        flex-direction: column;
                    }

                    & label {
                        font-size: 1.2rem;
                        margin-bottom: 0.5rem;
                        font-family: var(--font-heading);
                        color: var(--primary);
                    }

                    & input, textarea, select {
                        border: 1px solid var(--primary);
                        border-bottom: 1px solid var(--primary);
                        padding: 0.75rem 0.5rem;
                        font-family: var(--font-body);
                        font-size: 1.1rem;
                        background-color: var(--accent); 
                        color: var(--primary);
                        width: 100%;
                    }

                    & textarea {
                        resize: vertical;
                    }
                }
                
                & #create, #update, #delete {
                    background-color: var(--text);
                    color: var(--primary);
                    border: 1px solid var(--text);
                    transition: transform 0.2s ease-out;

                    &:hover {
                        background-color: var(--primary);
                        color: var(--text);
                        cursor: pointer;
                    }
                }
            }
        </style>
    </head>

    <body>
        <h1>CRUD on Project Cards</h1>
        <form id="crud-form">
            <fieldset>
                <legend>Project Details</legend>
                <div>
                    <label for="title">Title:</label>
                    <input type="text" id="title" name="title" required>
                </div>

                <div>
                    <label for="image">Image URL:</label>
                    <input type="url" id="image" name="image">
                </div>

                <div>
                    <label for="description">Description:</label>
                    <textarea id="description" name="description" rows="4" ></textarea>
                </div>

                <div>
                    <label for="url">Project Link:</label>
                    <input type="url" id="url" name="url">
                </div>

                <div>
                    <label for="ready">Ready to be released?</label>
                        <select id="ready" name="ready">
                            <option value="" disabled selected>Select Status</option> 
                            <option value="VIEW PROJECT">VIEW PROJECT</option>
                            <option value="COMING SOON!">COMING SOON!</option>
                        </select>
                </div>
            </fieldset>
            <button id="create" type="button">Create Project</button>
            <button id="update" type="button">Update Project</button>
            <button id="delete" type="button">Delete Project</button>
        </form>
    </body>
    
    <script>
        const STORED_DATA = 'localProjects';
        const crudForm = document.getElementById('crud-form');
        const createBtn = document.getElementById('create');
        const updateBtn = document.getElementById('update');
        const deleteBtn = document.getElementById('delete');

        crudForm.addEventListener('submit', function(event) {
            event.preventDefault();    
        });

        function getProjectsData() {
            const storedString = localStorage.getItem(STORED_DATA);
            return storedString ? JSON.parse(storedString).projects : [];
        }

        function saveProjectsData(projectsArray) {
            const dataObject = { projects: projectsArray };
            localStorage.setItem(STORED_DATA, JSON.stringify(dataObject));
        }

        createBtn.addEventListener('click', function(event) {
            event.preventDefault();

            if (!crudForm.title.value || !crudForm.image.value || !crudForm.description.value || !crudForm.url.value || !crudForm.ready.value) {
                alert("Please fill out ALL fields to create a new project.");
                return; 
            }

            const newProject = {
                title: document.getElementById('title').value,
                image: document.getElementById('image').value,
                desc: document.getElementById('description').value,
                url: document.getElementById('url').value,
                view: document.getElementById('ready').value
            };

            let projects = getProjectsData();
            projects.push(newProject);
            saveProjectsData(projects);
            alert('Project created successfully!');
            
            crudForm.reset();
        });

        updateBtn.addEventListener('click', function(event) {
            event.preventDefault();

            const title = document.getElementById('title').value;
            let projects = getProjectsData();
            const projectIndex = projects.findIndex(proj => proj.title === title);

            if (projectIndex !== -1) {
                const currentProject = projects[projectIndex];

                currentProject.image = document.getElementById('image').value || currentProject.image;
                currentProject.desc = document.getElementById('description').value || currentProject.desc;
                currentProject.url = document.getElementById('url').value || currentProject.url;
                currentProject.view = document.getElementById('ready').value || currentProject.view;

                saveProjectsData(projects);
                alert('Project updated successfully!');
            } else {
                alert('Project not found!');
            }
            crudForm.reset();
        });

        deleteBtn.addEventListener('click', function(event) {
            event.preventDefault();

            const title = document.getElementById('title').value;
            let projects = getProjectsData();
            const projectIndex = projects.findIndex(proj => proj.title === title);

            if (projectIndex !== -1) {
                projects.splice(projectIndex, 1);
                saveProjectsData(projects);
                alert('Project deleted successfully!');
            } else {
                alert('Project not found!');
            }
            crudForm.reset();
        });
    </script>
</html>